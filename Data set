import pandas as pd
import numpy as np

# Load the Iris dataset from a URL
url = "https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data"
column_names = ['sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'class']
df = pd.read_csv(url, names=column_names)

# Display the first few rows
print("First 5 rows of the dataset:")
print(df.head())
print("\n" + "="*50 + "\n")

# Display basic information about the dataset
print("Dataset info:")
print(df.info())
print("\n" + "="*50 + "\n")

# Check for missing values
print("Missing values in each column:")
print(df.isnull().sum())
print("\n" + "="*50 + "\n")

# Display statistical summary
print("Statistical summary:")
print(df.describe())
print("\n" + "="*50 + "\n")

# Check data types
print("Data types:")
print(df.dtypes)
print("\n" + "="*50 + "\n")

# Since the Iris dataset is typically clean, let's create some missing values for demonstration
# and then clean them

# Create a copy and introduce some missing values for demonstration
df_clean = df.copy()
np.random.seed(42)  # For reproducible results

# Introduce 5 random missing values in each numerical column
for col in ['sepal_length', 'sepal_width', 'petal_length', 'petal_width']:
    missing_indices = np.random.choice(df.index, size=5, replace=False)
    df_clean.loc[missing_indices, col] = np.nan

print("After introducing missing values:")
print("Missing values count:")
print(df_clean.isnull().sum())
print("\n" + "="*50 + "\n")

# Cleaning strategy: Fill numerical missing values with median
for col in ['sepal_length', 'sepal_width', 'petal_length', 'petal_width']:
    median_value = df_clean[col].median()
    df_clean[col].fillna(median_value, inplace=True)

print("After cleaning (filling missing values with median):")
print("Missing values count:")
print(df_clean.isnull().sum())
print("\n" + "="*50 + "\n")

# Verify the cleaning worked
print("Dataset shape:", df_clean.shape)
print("Total missing values after cleaning:", df_clean.isnull().sum().sum())

# Display first few rows of cleaned dataset
print("\nFirst 5 rows of cleaned dataset:")
print(df_clean.head())
